import{_ as M,u as B,r,g as T,A as w,o as V,c as j,a as S,b as s,d as p,h as y,t as N,w as P,v,i as E,F as $,N as A,S as D,e as H,p as L,f as R}from"./index-ac545b60.js";const l=h=>(L("data-v-e083d3c2"),h=h(),R(),h),F={class:"container",style:{"margin-top":"10px"}},J={class:"row"},z={class:"col-auto"},Y={class:"profile-container"},G=l(()=>s("div",{class:"editIcon-container btn"},[s("button",{type:"button",class:"btn btn-link",style:{padding:"0%"},"data-bs-toggle":"modal","data-bs-target":"#exampleModal"},[s("img",{class:"editIcon",src:"https://cdn-icons-png.flaticon.com/512/1860/1860115.png",alt:"..."})])],-1)),W=["src"],q={class:"col align-self-center"},K={class:"row align-self-center"},Q={class:"col-auto"},X={class:"col-auto",style:{"padding-left":"0%"}},Z=l(()=>s("img",{class:"editIcon",src:"https://cdn-icons-png.flaticon.com/512/1860/1860115.png",alt:"..."},null,-1)),ee=[Z],se={class:"row"},te={class:"col-auto"},ae={class:"col-auto",style:{"padding-left":"0%"}},oe=l(()=>s("img",{class:"editIcon",src:"https://cdn-icons-png.flaticon.com/512/1860/1860115.png",alt:"..."},null,-1)),le=[oe],ne={key:0,class:"row"},ie=l(()=>s("h5",null,"You are an administrator !",-1)),re=[ie],de={class:"row mt-4"},ue={class:"form-floating mb-3"},ce=l(()=>s("label",{for:"oldPasswordInput"},"Old password",-1)),pe={class:"form-floating mb-3"},me=l(()=>s("label",{for:"newPasswordInput"},"New password",-1)),ve={class:"form-floating mb-3"},fe=l(()=>s("label",{for:"confirmPasswordInput"},"Confirm password",-1)),ge=l(()=>s("div",{class:"align-item-center text-center"},[s("button",{type:"submit",class:"btn btn-success",style:{width:"auto"}},"Submit")],-1)),_e={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",style:{"margin-top":"20vh"}},he={class:"modal-dialog"},be={class:"modal-content"},we={class:"modal-body"},ye={class:"row"},Pe={class:"col"},Ue={class:"form-floating mb-3"},xe=l(()=>s("label",{for:"ppRegister"},"Profile Picture link",-1)),Ie=l(()=>s("div",{class:"col-auto"},[s("button",{id:"closeNewPPModal",type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),U="/api/",Se={__name:"ProfileView",setup(h){const d=B(),u={position:"bottom-right",timeout:5e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!0,closeButton:!1,icon:!0,rtl:!1},t=r({username:"",emailUser:"",ppUser:"",isAdmin:0}),n=r(!1),c=r(""),i=r(!1),m=r(""),b=r(""),f=r(""),g=r(""),_=r("");t.value={username:"",emailUser:"",ppUser:"",isAdmin:1},T(()=>{fetch(U+"users/@me",{headers:w.authHeader()}).then(o=>o.json()).then(o=>{t.value=o,c.value=t.value.username,m.value=t.value.emailUser,(t.value.ppUser===""||t.value.ppUser==null)&&(t.value.ppUser="https://tp.gensdeconfiance.com/images/defaults/man.png?twic=v1/output=jpeg")}).catch(o=>console.log("Error"))});function x(){n.value==!0&&(c.value=t.value.username),n.value==!1&&i.value==!0&&I(),n.value=!n.value}function I(){i.value==!0&&(m.value=t.value.emailUser),i.value==!1&&n.value==!0&&x(),i.value=!i.value}function k(){let o;c.value!==t.value.username?o={username:c.value}:o={emailUser:m.value},i.value=!1,n.value=!1,fetch(U+"users/@me",{method:"PUT",headers:Object.assign({"Content-Type":"application/json"},w.authHeader()),body:JSON.stringify(o)}).then(e=>e.json()).then(e=>{e.message==="Value unchanged"?d.warning(e.message,u):e.message==="User updated"&&(c.value!==t.value.username?t.value.username=c.value:t.value.emailUser=m.value,d.success(e.message,u))}).catch(e=>console.log(e))}function C(){if(i.value&&I(),n.value&&x(),f.value!==g.value)d.error("The confirm password must be the same than the new one",u);else{const o={oldPassword:b.value,passwordUser:f.value,confirmPassword:g.value};fetch(U+"users/@me/password",{method:"PUT",headers:Object.assign({"Content-Type":"application/json"},w.authHeader()),body:JSON.stringify(o)}).then(e=>e.json()).then(e=>{e.message==="Password updated"?(d.success(e.message,u),b.value="",f.value="",g.value=""):e.message==="Value unchanged"?d.warning(e.message,u):e.message==="Wrong password"?d.error(e.message,u):console.log(e)}).catch(e=>console.log(e))}}function O(){const o={ppUser:_.value};fetch(U+"users/@me",{method:"PUT",headers:Object.assign({"Content-Type":"application/json"},w.authHeader()),body:JSON.stringify(o)}).then(e=>e.json()).then(e=>{e.message==="Value unchanged"?d.warning(e.message,u):e.message==="User updated"&&(document.getElementById("closeNewPPModal").click(),t.value.ppUser=_.value,_.value="",d.success(e.message,u))})}return(o,e)=>(V(),j($,null,[S(A),S(D),S(H,{title:"YouGame - Profile"}),s("div",F,[s("div",J,[s("div",z,[s("div",Y,[G,s("img",{src:t.value.ppUser,class:"rounded resized-image",alt:"Profile Picture"},null,8,W)])]),s("div",q,[s("div",K,[s("div",Q,[p(s("h1",{class:"text-break"},N(t.value.username),513),[[y,!n.value]]),s("form",{onSubmit:e[1]||(e[1]=P(a=>k(),["prevent"]))},[p(s("input",{type:"text",class:"form-control",placeholder:"Username","aria-label":"Username","aria-describedby":"basic-addon1","onUpdate:modelValue":e[0]||(e[0]=a=>c.value=a),style:{"font-size":"32px"}},null,512),[[y,n.value],[v,c.value]])],32)]),s("div",X,[s("button",{type:"button",class:"btn btn-link",style:{padding:"0%"},onClick:e[2]||(e[2]=a=>x())},ee)])]),s("div",se,[s("div",te,[p(s("h4",{class:"text-break"},N(t.value.emailUser),513),[[y,!i.value]]),s("form",{onSubmit:e[4]||(e[4]=P(a=>k(),["prevent"]))},[p(s("input",{type:"text",class:"form-control",placeholder:"E-Mail","aria-label":"E-Mail","aria-describedby":"basic-addon1","onUpdate:modelValue":e[3]||(e[3]=a=>m.value=a)},null,512),[[y,i.value],[v,m.value]])],32)]),s("div",ae,[s("button",{type:"button",class:"btn btn-link",style:{padding:"0%"},onClick:e[5]||(e[5]=a=>I())},le)])]),t.value.isAdmin==1?(V(),j("div",ne,re)):E("",!0)])]),s("div",de,[s("form",{onSubmit:e[9]||(e[9]=P(a=>C(),["prevent"]))},[s("div",ue,[p(s("input",{type:"password",class:"form-control",id:"oldPasswordInput",placeholder:"Password","onUpdate:modelValue":e[6]||(e[6]=a=>b.value=a)},null,512),[[v,b.value]]),ce]),s("div",pe,[p(s("input",{type:"password",class:"form-control",id:"newPasswordInput",placeholder:"Password","onUpdate:modelValue":e[7]||(e[7]=a=>f.value=a)},null,512),[[v,f.value]]),me]),s("div",ve,[p(s("input",{type:"password",class:"form-control",id:"confirmPasswordInput",placeholder:"Password","onUpdate:modelValue":e[8]||(e[8]=a=>g.value=a)},null,512),[[v,g.value]]),fe]),ge],32)]),s("div",_e,[s("div",he,[s("div",be,[s("div",we,[s("div",ye,[s("div",Pe,[s("form",{onSubmit:e[11]||(e[11]=P(a=>O(),["prevent"]))},[s("div",Ue,[p(s("input",{type:"url",class:"form-control",id:"ppRegister",placeholder:"*.png",pattern:"https?://.+\\.(jpg|jpeg|png|gif|bmp)",title:"Please enter a valid image URL (e.g., http://example.com/image.jpg)","onUpdate:modelValue":e[10]||(e[10]=a=>_.value=a)},null,512),[[v,_.value]]),xe])],32)]),Ie])])])])])])],64))}},Ve=M(Se,[["__scopeId","data-v-e083d3c2"]]);export{Ve as default};
